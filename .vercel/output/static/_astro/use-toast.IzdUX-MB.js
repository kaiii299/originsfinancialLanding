import{r as o}from"./index.DU5konRZ.js";import{e as w,P as m,f as T,g as X,u as Y,R as G}from"./index.DYDKMoXp.js";import{u as M}from"./index.DTKtUVq8.js";import{j as O}from"./utils.JnRaa0S_.js";function Q(e,t=globalThis?.document){const s=w(e);o.useEffect(()=>{const n=r=>{r.key==="Escape"&&s(r)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[s,t])}var q="DismissableLayer",S="dismissableLayer.update",J="dismissableLayer.pointerDownOutside",Z="dismissableLayer.focusOutside",I,B=o.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),N=o.forwardRef((e,t)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:a,onInteractOutside:d,onDismiss:l,...p}=e,u=o.useContext(B),[c,k]=o.useState(null),f=c?.ownerDocument??globalThis?.document,[,U]=o.useState({}),j=M(t,i=>k(i)),L=Array.from(u.layers),[H]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),V=L.indexOf(H),R=c?L.indexOf(c):-1,z=u.layersWithOutsidePointerEventsDisabled.size>0,A=R>=V,K=ee(i=>{const v=i.target,C=[...u.branches].some(D=>D.contains(v));!A||C||(r?.(i),d?.(i),i.defaultPrevented||l?.())},f),g=te(i=>{const v=i.target;[...u.branches].some(D=>D.contains(v))||(a?.(i),d?.(i),i.defaultPrevented||l?.())},f);return Q(i=>{R===u.layers.size-1&&(n?.(i),!i.defaultPrevented&&l&&(i.preventDefault(),l()))},f),o.useEffect(()=>{if(c)return s&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(I=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),_(),()=>{s&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=I)}},[c,f,s,u]),o.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),_())},[c,u]),o.useEffect(()=>{const i=()=>U({});return document.addEventListener(S,i),()=>document.removeEventListener(S,i)},[]),O.jsx(m.div,{...p,ref:j,style:{pointerEvents:z?A?"auto":"none":void 0,...e.style},onFocusCapture:T(e.onFocusCapture,g.onFocusCapture),onBlurCapture:T(e.onBlurCapture,g.onBlurCapture),onPointerDownCapture:T(e.onPointerDownCapture,K.onPointerDownCapture)})});N.displayName=q;var $="DismissableLayerBranch",F=o.forwardRef((e,t)=>{const s=o.useContext(B),n=o.useRef(null),r=M(t,n);return o.useEffect(()=>{const a=n.current;if(a)return s.branches.add(a),()=>{s.branches.delete(a)}},[s.branches]),O.jsx(m.div,{...e,ref:r})});F.displayName=$;function ee(e,t=globalThis?.document){const s=w(e),n=o.useRef(!1),r=o.useRef(()=>{});return o.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let p=function(){W(J,s,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",r.current),r.current=p,t.addEventListener("click",r.current,{once:!0})):p()}else t.removeEventListener("click",r.current);n.current=!1},d=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(d),t.removeEventListener("pointerdown",a),t.removeEventListener("click",r.current)}},[t,s]),{onPointerDownCapture:()=>n.current=!0}}function te(e,t=globalThis?.document){const s=w(e),n=o.useRef(!1);return o.useEffect(()=>{const r=a=>{a.target&&!n.current&&W(Z,s,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",r),()=>t.removeEventListener("focusin",r)},[t,s]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function _(){const e=new CustomEvent(S);document.dispatchEvent(e)}function W(e,t,s,{discrete:n}){const r=s.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:s});t&&r.addEventListener(e,t,{once:!0}),n?X(r,a):r.dispatchEvent(a)}var ve=N,ye=F,se="Portal",ne=o.forwardRef((e,t)=>{const{container:s,...n}=e,[r,a]=o.useState(!1);Y(()=>a(!0),[]);const d=s||r&&globalThis?.document?.body;return d?G.createPortal(O.jsx(m.div,{...n,ref:t}),d):null});ne.displayName=se;var re="VisuallyHidden",oe=o.forwardRef((e,t)=>O.jsx(m.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));oe.displayName=re;const ie=1,ae=1e6;let b=0;function ue(){return b=(b+1)%Number.MAX_SAFE_INTEGER,b.toString()}const P=new Map,x=e=>{if(P.has(e))return;const t=setTimeout(()=>{P.delete(e),E({type:"REMOVE_TOAST",toastId:e})},ae);P.set(e,t)},ce=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,ie)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?x(s):e.toasts.forEach(n=>{x(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===s||s===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)}}},y=[];let h={toasts:[]};function E(e){h=ce(h,e),y.forEach(t=>{t(h)})}function de({...e}){const t=ue(),s=r=>E({type:"UPDATE_TOAST",toast:{...r,id:t}}),n=()=>E({type:"DISMISS_TOAST",toastId:t});return E({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:r=>{r||n()}}}),{id:t,dismiss:n,update:s}}function he(){const[e,t]=o.useState(h);return o.useEffect(()=>(y.push(t),()=>{const s=y.indexOf(t);s>-1&&y.splice(s,1)}),[e]),{...e,toast:de,dismiss:s=>E({type:"DISMISS_TOAST",toastId:s})}}export{ye as B,N as D,ne as P,ve as R,oe as V,de as t,he as u};
